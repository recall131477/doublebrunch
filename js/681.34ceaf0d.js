"use strict";(self["webpackChunkdoublebrunch"]=self["webpackChunkdoublebrunch"]||[]).push([[681],{5679:function(t,e,i){function r(t){return{all:t=t||new Map,on:function(e,i){var r=t.get(e);r?r.push(i):t.set(e,[i])},off:function(e,i){var r=t.get(e);r&&(i?r.splice(r.indexOf(i)>>>0,1):t.set(e,[]))},emit:function(e,i){var r=t.get(e);r&&r.slice().map((function(t){t(i)})),(r=t.get("*"))&&r.slice().map((function(t){t(e,i)}))}}}i.d(e,{Z:function(){return s}});const o=r();var s=o},6294:function(t,e,i){var r=i(8262);e["Z"]=(0,r.Q_)("statusStore",{state:()=>({isLoading:!1}),actions:{changeLoading(){this.isLoading=!this.isLoading}}})},8729:function(t,e,i){i.d(e,{Z:function(){return u}});var r=i(6252),o=i(3577);const s=(0,r._)("div",{class:"loading__main"},[(0,r._)("div",{class:"loading__square absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[60px] h-[60px] bg-primary rounded -mt-2"}),(0,r._)("span",{class:"relative block text-24px text-secondary w-full h-full pt-2"},"午")],-1),a=[s];function n(t,e,i,s,n,l){return(0,r.wg)(),(0,r.iD)("div",{class:(0,o.C_)(["loading",{"is-active":i.isLoading}])},a,2)}var l={props:{isLoading:{type:Boolean,default:!1}}},c=i(3744);const d=(0,c.Z)(l,[["render",n]]);var u=d},681:function(t,e,i){i.r(e),i.d(e,{default:function(){return X}});var r=i(6252),o=i(9963),s=i(3577),a=i(6633),n=i(4220),l=i(9653);const c={class:"pt-[30px] px-5 pb-5"},d={class:"relative border-primary border-2 mb-2.5"},u=(0,r._)("img",{src:a,alt:"放大鏡",class:"absolute top-1/2 right-5 -translate-y-1/2"},null,-1),p={class:"text-primary mb-5"},h=(0,r.Uk)(" 共有 "),g={class:"text-24px"},f=(0,r.Uk)(" 筆搜尋結果 "),m={class:"grid grid-cols-1 gap-5 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5"},v={class:"relative border-primary border-2"},w={class:"absolute top-0 left-5 z-20"},y=(0,r._)("img",{src:n,alt:"標籤"},null,-1),x={class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-white"},b={class:"relative pt-[100%] overflow-hidden"},_=["src","alt"],k={class:"flex justify-between border-primary border-b-2 p-5"},C={class:"text-20px text-primary"},L={class:"text-20px text-primary"},Z={class:"flex"},B=["onClick"],$={key:0,src:l,alt:"愛心",class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},D={key:1,class:"duration-300 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 stroke-primary fill-transparent group-hover:fill-primary",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"20",height:"20",viewBox:"0 0 20 20"},j=(0,r._)("defs",null,[(0,r._)("clipPath",{id:"clip-icon-favorite"},[(0,r._)("rect",{width:"20",height:"20"})])],-1),z=(0,r._)("g",{id:"icon-favorite","clip-path":"url(#clip-icon-favorite)"},[(0,r._)("path",{id:"heart-solid",d:"M14.435,32.924a4.273,4.273,0,0,0-5.831.425l-.616.634-.616-.634a4.273,4.273,0,0,0-5.831-.425,4.487,4.487,0,0,0-.309,6.5l6.047,6.244a.98.98,0,0,0,1.416,0l6.047-6.244a4.484,4.484,0,0,0-.306-6.5Z",transform:"translate(2.012 -28.967)","stroke-width":"2"})],-1),I=[j,z],M={class:"relative flex-1"},P={key:0,type:"button",class:"flex justify-center items-center text-primary border-primary border-l-2 w-full h-full pointer-events-none"},q=["onClick"],F=(0,r._)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",class:"duration-[400ms] stroke-primary group-hover:stroke-white"},[(0,r._)("rect",{width:"16",height:"12",rx:"3",transform:"translate(2 6)",fill:"none","stroke-width":"2"}),(0,r._)("path",{d:"M13,9V5A4,4,0,0,0,5,5V9",transform:"translate(1 1)",fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1),S=(0,r._)("span",{class:"ml-3"},"加入購物車",-1),N=[F,S],U={class:"absolute inset-0 flex justify-center items-center bg-primary"},V=(0,r.uE)('<div class="flex items-center"><svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><span class="text-white">加入中...</span></div>',1),H=[V];function O(t,e,i,a,n,l){const j=(0,r.up)("LoadingComponent"),z=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(j,{isLoading:t.isLoading},null,8,["isLoading"]),(0,r._)("section",null,[(0,r._)("div",c,[(0,r._)("div",d,[(0,r.wy)((0,r._)("input",{type:"text",id:"keyword",class:"text-primary bg-secondary w-full h-[60px] px-5","onUpdate:modelValue":e[0]||(e[0]=t=>n.keyword=t)},null,512),[[o.nr,n.keyword]]),u]),(0,r._)("p",p,[h,(0,r._)("span",g,(0,s.zw)(l.filterProducts.length),1),f]),(0,r._)("ul",m,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(l.filterProducts,(e=>((0,r.wg)(),(0,r.iD)("li",{key:e.id},[(0,r._)("div",v,[(0,r._)("div",w,[y,(0,r._)("span",x,(0,s.zw)(e.category),1)]),(0,r.Wm)(z,{to:`/product/${e.id}`,class:"group block"},{default:(0,r.w5)((()=>[(0,r._)("div",b,[(0,r._)("img",{src:e.imageUrl,alt:e.title,class:"duration-300 absolute top-0 left-0 w-full h-full object-cover group-hover:scale-110"},null,8,_)])])),_:2},1032,["to"]),(0,r._)("div",k,[(0,r._)("h4",C,(0,s.zw)(e.title),1),(0,r._)("span",L,"$"+(0,s.zw)(t.$filters.currency(e.price)),1)]),(0,r._)("div",Z,[(0,r._)("button",{type:"button",class:"relative w-[60px] h-[60px] group",onClick:t=>l.toggleFavorite(e)},[l.isFavorite(e)?((0,r.wg)(),(0,r.iD)("img",$)):((0,r.wg)(),(0,r.iD)("svg",D,I))],8,B),(0,r._)("div",M,[l.isMaxNum(e)?((0,r.wg)(),(0,r.iD)("button",P," 商品已達購買上限 ")):((0,r.wg)(),(0,r.iD)("button",{key:1,type:"button",class:"btn duration-[400ms] flex justify-center items-center border-primary border-l-2 w-full h-full group",onClick:t=>l.addToCart(e.id)},N,8,q)),(0,r.wy)((0,r._)("div",U,H,512),[[o.F8,n.isLoadingItem===e.id]])])])])])))),128))])])])],64)}var A=i(6455),J=i.n(A),R=i(5679),T=i(8262),W=i(6294),Y=i(8729);const E=(0,W.Z)();var K={components:{LoadingComponent:Y.Z},inject:["routerRefresh"],watch:{$route:{handler(){this.routerRefresh()}},favorite:{handler(){localStorage.setItem("favorite",JSON.stringify(this.favorite)),R.Z.emit("get-favorite")},deep:!0}},data(){return{products:[],cart:{carts:[]},keyword:"",favorite:JSON.parse(localStorage.getItem("favorite"))||[],isLoadingItem:""}},computed:{...(0,T.rn)(W.Z,["isLoading"]),filterProducts(){return""===this.keyword?this.products:this.products.filter((t=>t.title.match(this.keyword)||t.category.match(this.keyword)))}},methods:{getProducts(){E.isLoading=!0;const t="https://vue3-course-api.hexschool.io/v2/api/rousong/products/all";this.$http.get(t).then((t=>{this.products=t.data.products,this.products.reverse(),E.isLoading=!1})).catch((t=>{J().fire({position:"top-end",icon:"error",title:t.response.data.message,showConfirmButton:!1,timer:1500})}))},getCart(){const t="https://vue3-course-api.hexschool.io/v2/api/rousong/cart";this.$http.get(t).then((t=>{this.cart=t.data.data})).catch((t=>{J().fire({position:"top-end",icon:"error",title:t.response.data.message,showConfirmButton:!1,timer:1500})}))},addToCart(t,e=1){this.isLoadingItem=t;const i={product_id:t,qty:e},r="https://vue3-course-api.hexschool.io/v2/api/rousong/cart",o="加入購物車";this.$http.post(r,{data:i}).then((()=>{J().fire({position:"top-end",icon:"success",title:o,showConfirmButton:!1,timer:1500}),R.Z.emit("get-cart"),this.getCart(),this.isLoadingItem=""})).catch((t=>{J().fire({position:"top-end",icon:"error",title:t.response.data.message,showConfirmButton:!1,timer:1500})}))},toggleFavorite(t){const e=this.favorite.findIndex((e=>e.id===t.id));-1===e?(this.favorite.push(t),J().fire({position:"top-end",icon:"success",title:"已加入我的最愛",showConfirmButton:!1,timer:1500})):(this.favorite.splice(e,1),J().fire({position:"top-end",icon:"success",title:"已移除我的最愛",showConfirmButton:!1,timer:1500}))},isFavorite(t){return this.favorite.some((e=>e.id===t.id))},isMaxNum(t){const e=this.cart.carts.filter((e=>e.product_id===t.id))[0];return e&&30===e.qty}},mounted(){this.$route.query.keyword&&(this.keyword=this.$route.query.keyword),this.getProducts(),this.getCart()}},Q=i(3744);const G=(0,Q.Z)(K,[["render",O]]);var X=G},9653:function(t,e,i){t.exports=i.p+"img/icon-heart-fill.67c81960.svg"},6633:function(t,e,i){t.exports=i.p+"img/icon-search.0126fede.svg"},4220:function(t,e,i){t.exports=i.p+"img/icon-tag.319e6611.svg"}}]);
//# sourceMappingURL=681.34ceaf0d.js.map