"use strict";(self["webpackChunkdoublebrunch"]=self["webpackChunkdoublebrunch"]||[]).push([[815],{5679:function(e,t,o){function n(e){return{all:e=e||new Map,on:function(t,o){var n=e.get(t);n?n.push(o):e.set(t,[o])},off:function(t,o){var n=e.get(t);n&&(o?n.splice(n.indexOf(o)>>>0,1):e.set(t,[]))},emit:function(t,o){var n=e.get(t);n&&n.slice().map((function(e){e(o)})),(n=e.get("*"))&&n.slice().map((function(e){e(t,o)}))}}}o.d(t,{Z:function(){return i}});const r=n();var i=r},8268:function(e,t,o){o.d(t,{Z:function(){return x}});var n=o(6252),r=o(3577),i=o(5604),a=o(6058);const s={class:"flex justify-center h-[60px] border-primary border-t-2"},l=["disabled"],p=(0,n._)("img",{src:i,alt:"icon-arrow-left",class:"duration-300 group-hover:scale-110"},null,-1),u=[p],d=["onClick"],c=["disabled"],h=(0,n._)("img",{src:a,alt:"icon-arrow-right",class:"duration-300 group-hover:scale-110"},null,-1),m=[h];function g(e,t,o,i,a,p){return(0,n.wg)(),(0,n.iD)("ul",s,[(0,n._)("li",null,[(0,n._)("button",{type:"button",class:(0,r.C_)(["flex justify-center items-center opacity-50 h-full cursor-not-allowed px-[25px] group",{"opacity-100 cursor-pointer":o.pages.has_pre}]),disabled:1===o.pages.current_page,onClick:t[0]||(t[0]=e=>p.changePages(o.pages.current_page-1))},u,10,l)]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(o.pages.total_pages,((e,t)=>((0,n.wg)(),(0,n.iD)("li",{key:t},[(0,n._)("button",{type:"button",class:(0,r.C_)(["duration-300 flex justify-center items-center text-primary opacity-50 h-full px-[15px] hover:text-primary hover:opacity-100",{"opacity-100":e===o.pages.current_page}]),onClick:t=>p.changePages(e)},(0,r.zw)(e),11,d)])))),128)),(0,n._)("li",null,[(0,n._)("button",{type:"button",class:(0,r.C_)(["flex justify-center items-center opacity-50 h-full cursor-not-allowed px-[25px] group",{"opacity-100 cursor-pointer":o.pages.has_next}]),disabled:o.pages.current_page===o.pages.total_pages,onClick:t[1]||(t[1]=e=>p.changePages(o.pages.current_page+1))},m,10,c)])])}var y={props:{pages:{type:Object,default(){return{}}}},methods:{changePages(e){this.$emit("change-pages",e)}}},b=o(3744);const f=(0,b.Z)(y,[["render",g]]);var x=f},1664:function(e,t,o){o.d(t,{Z:function(){return w}});var n=o(6252),r=o(3577);const i={class:"relative flex justify-center items-center w-full min-h-[calc(100%-2.5rem)] max-w-[960px] pointer-events-none mx-auto my-5"},a={class:"w-full pointer-events-auto"},s=(0,n._)("h2",{class:"text-white bg-warning text-center py-5"},"刪除",-1),l={class:"bg-secondary"},p={class:"p-5"},u={key:0,class:"text-20px text-primary"},d={key:1,class:"text-20px text-primary"},c={key:2,class:"text-20px text-primary"},h={key:3,class:"text-20px text-primary"},m={class:"text-right border-primary border-t-2 p-5"};function g(e,t,o,g,y,b){return(0,n.wg)(),(0,n.iD)("div",{class:(0,r.C_)(["duration-300 fixed overflow-y-auto z-[1000] inset-0",{"opacity-0 invisible":!y.isOpen,"opacity-100 visible":y.isOpen}])},[(0,n._)("div",{class:"fixed top-0 left-0 w-full h-full bg-primary bg-opacity-50",onClick:t[0]||(t[0]=(...e)=>b.closeModal&&b.closeModal(...e))}),(0,n._)("div",i,[(0,n._)("div",a,[s,(0,n._)("div",l,[(0,n._)("div",p,["product"===o.navItem?((0,n.wg)(),(0,n.iD)("h3",u," 是否刪除商品："+(0,r.zw)(o.delProduct.title)+" (刪除後將無法恢復) ",1)):(0,n.kq)("",!0),"order"===o.navItem?((0,n.wg)(),(0,n.iD)("h3",d," 是否刪除訂單編號："+(0,r.zw)(o.delOrder.id)+" (刪除後將無法恢復) ",1)):(0,n.kq)("",!0),"coupon"===o.navItem?((0,n.wg)(),(0,n.iD)("h3",c," 是否刪除優惠券："+(0,r.zw)(o.delCoupon.title)+" (刪除後將無法恢復) ",1)):(0,n.kq)("",!0),"article"===o.navItem?((0,n.wg)(),(0,n.iD)("h3",h," 是否刪除文章："+(0,r.zw)(o.delArticle.title)+" (刪除後將無法恢復) ",1)):(0,n.kq)("",!0)]),(0,n._)("div",m,[(0,n._)("button",{type:"button",class:"duration-300 text-warning border-warning border-2 px-12 py-2.5 hover:text-white hover:bg-warning",onClick:t[1]||(t[1]=(...e)=>b.closeModal&&b.closeModal(...e))}," 取消 "),"product"===o.navItem?((0,n.wg)(),(0,n.iD)("button",{key:0,type:"button",class:"duration-300 text-primary border-primary border-2 px-12 py-2.5 ml-2.5 hover:text-white hover:bg-primary",onClick:t[2]||(t[2]=(...e)=>b.deleteProduct&&b.deleteProduct(...e))}," 確認刪除 ")):(0,n.kq)("",!0),"order"===o.navItem?((0,n.wg)(),(0,n.iD)("button",{key:1,type:"button",class:"duration-300 text-primary border-primary border-2 px-12 py-2.5 ml-2.5 hover:text-white hover:bg-primary",onClick:t[3]||(t[3]=(...e)=>b.deleteOrder&&b.deleteOrder(...e))}," 確認刪除 ")):(0,n.kq)("",!0),"coupon"===o.navItem?((0,n.wg)(),(0,n.iD)("button",{key:2,type:"button",class:"duration-300 text-primary border-primary border-2 px-12 py-2.5 ml-2.5 hover:text-white hover:bg-primary",onClick:t[4]||(t[4]=(...e)=>b.deleteCoupon&&b.deleteCoupon(...e))}," 確認刪除 ")):(0,n.kq)("",!0),"article"===o.navItem?((0,n.wg)(),(0,n.iD)("button",{key:3,type:"button",class:"duration-300 text-primary border-primary border-2 px-12 py-2.5 ml-2.5 hover:text-white hover:bg-primary",onClick:t[5]||(t[5]=(...e)=>b.deleteArticle&&b.deleteArticle(...e))}," 確認刪除 ")):(0,n.kq)("",!0)])])])])],2)}var y=o(6455),b=o.n(y),f={props:{delProduct:{type:Object,default(){return{}}},delOrder:{type:Object,default(){return{}}},delCoupon:{type:Object,default(){return{}}},delArticle:{type:Object,default(){return{}}},currentPage:{type:Number,default:1},navItem:{type:String,default:""}},data(){return{isOpen:!1}},methods:{deleteProduct(){const e="刪除商品成功",{id:t}=this.delProduct,o=`https://vue3-course-api.hexschool.io/v2/api/rousong/admin/product/${t}`;this.$http.delete(o).then((()=>{b().fire({position:"top-end",icon:"success",title:e,showConfirmButton:!1,timer:1500}),this.$emit("update-product",this.currentPage),this.closeModal()})).catch((e=>{b().fire({position:"top-end",icon:"error",title:e.response.data.message,showConfirmButton:!1,timer:1500})}))},deleteOrder(){const e="刪除訂單成功",{id:t}=this.delOrder,o=`https://vue3-course-api.hexschool.io/v2/api/rousong/admin/order/${t}`;this.$http.delete(o).then((()=>{b().fire({position:"top-end",icon:"success",title:e,showConfirmButton:!1,timer:1500}),this.$emit("update-order",this.currentPage),this.closeModal()})).catch((e=>{b().fire({position:"top-end",icon:"error",title:e.response.data.message,showConfirmButton:!1,timer:1500})}))},deleteCoupon(){const e="刪除優惠券成功",{id:t}=this.delCoupon,o=`https://vue3-course-api.hexschool.io/v2/api/rousong/admin/coupon/${t}`;this.$http.delete(o).then((()=>{b().fire({position:"top-end",icon:"success",title:e,showConfirmButton:!1,timer:1500}),this.$emit("update-coupon",this.currentPage),this.closeModal()})).catch((e=>{b().fire({position:"top-end",icon:"error",title:e.response.data.message,showConfirmButton:!1,timer:1500})}))},deleteArticle(){const e="刪除文章成功",{id:t}=this.delArticle,o=`https://vue3-course-api.hexschool.io/v2/api/rousong/admin/article/${t}`;this.$http.delete(o).then((()=>{b().fire({position:"top-end",icon:"success",title:e,showConfirmButton:!1,timer:1500}),this.$emit("update-article",this.currentPage),this.closeModal()})).catch((e=>{b().fire({position:"top-end",icon:"error",title:e.response.data.message,showConfirmButton:!1,timer:1500})}))},openModal(){this.isOpen=!0},closeModal(){this.isOpen=!1}}},x=o(3744);const v=(0,x.Z)(f,[["render",g]]);var w=v},9815:function(e,t,o){o.r(t),o.d(t,{default:function(){return T}});var n=o(6252),r=o(3577),i=o(9963);const a={class:"text-right h-[100px] p-5"},s={class:"border-primary border-t-2"},l=(0,n._)("li",null,[(0,n._)("ul",{class:"grid grid-cols-5 text-primary px-5 py-2.5"},[(0,n._)("li",null,"名稱"),(0,n._)("li",null,"折扣百分比"),(0,n._)("li",null,"到期日"),(0,n._)("li",null,"是否啟用"),(0,n._)("li",null,"編輯")])],-1),p={class:"grid grid-cols-5 items-center text-primary border-primary border-t-2 px-5 py-2.5"},u={class:"flex items-center"},d=["id","disabled","onUpdate:modelValue","onChange"],c=["for"],h={key:0},m={class:"grid grid-cols-2 gap-x-2.5"},g={class:"col-span-1"},y=["onClick"],b={class:"col-span-1"},f=["onClick"];function x(e,t,o,x,v,w){const C=(0,n.up)("Pagination"),_=(0,n.up)("CouponModal"),k=(0,n.up)("DeleteModal");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",a,[(0,n._)("button",{type:"button",class:"btn-light text-white bg-primary h-full w-40",onClick:t[0]||(t[0]=e=>w.openModal("add"))}," 建立新的優惠券 ")]),(0,n._)("ul",s,[l,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(v.coupons,((t,o)=>((0,n.wg)(),(0,n.iD)("li",{key:o},[(0,n._)("ul",p,[(0,n._)("li",null,(0,r.zw)(t.title),1),(0,n._)("li",null,(0,r.zw)(t.percent)+"%",1),(0,n._)("li",null,(0,r.zw)(e.$filters.date(t.due_date)),1),(0,n._)("li",null,[(0,n._)("div",u,[(0,n.wy)((0,n._)("input",{type:"checkbox",id:`${t.id}`,class:"btn-check mr-2","true-value":1,"false-value":0,disabled:v.tempId===t.id,"onUpdate:modelValue":e=>t.is_enabled=e,onChange:e=>w.updateCoupon(t)},null,40,d),[[i.e8,t.is_enabled]]),(0,n._)("label",{for:`${t.id}`},[t.is_enabled?((0,n.wg)(),(0,n.iD)("span",h,"啟用")):((0,n.wg)(),(0,n.iD)("span",{key:1,class:(0,r.C_)({"text-warning":!t.is_enabled})},"未啟用",2))],8,c)])]),(0,n._)("li",m,[(0,n._)("div",g,[(0,n._)("button",{type:"button",class:"duration-300 border-primary border-2 w-full py-2.5 hover:text-white hover:bg-primary",onClick:e=>w.openModal("edit",t)}," 編輯 ",8,y)]),(0,n._)("div",b,[(0,n._)("button",{type:"button",class:"duration-300 text-warning border-warning border-2 w-full py-2.5 hover:text-white hover:bg-warning",onClick:e=>w.openModal("delete",t)}," 刪除 ",8,f)])])])])))),128))]),v.pagination.total_pages>1?((0,n.wg)(),(0,n.j4)(C,{key:0,pages:v.pagination,onChangePages:w.getCoupons},null,8,["pages","onChangePages"])):(0,n.kq)("",!0),(0,n.Wm)(_,{ref:"couponModal",coupon:v.tempCoupon,status:v.status,currentPage:v.pagination.current_page,onUpdateCoupon:w.getCoupons,onCancelId:w.cancelId},null,8,["coupon","status","currentPage","onUpdateCoupon","onCancelId"]),(0,n.Wm)(k,{ref:"delCouponModal",delCoupon:v.tempCoupon,currentPage:v.pagination.current_page,navItem:v.navItem,onUpdateCoupon:w.getCoupons},null,8,["delCoupon","currentPage","navItem","onUpdateCoupon"])],64)}var v=o(6455),w=o.n(v),C=o(5679),_=o(8268);const k={class:"relative flex justify-center items-center w-full min-h-[calc(100%-2.5rem)] max-w-[960px] pointer-events-none mx-auto my-5"},M={class:"w-full pointer-events-auto"},D={key:0,class:"text-white bg-primary text-center py-5"},O={key:1,class:"text-white bg-primary text-center py-5"},P={class:"bg-secondary"},$={class:"space-y-5 p-5"},I=(0,n._)("label",{for:"title",class:"block text-primary w-full mb-1"},"標題",-1),j=(0,n._)("label",{for:"couponCode",class:"block text-primary w-full mb-1"},"優惠碼",-1),S=(0,n._)("label",{for:"dueDate",class:"block text-primary w-full mb-1"},"到期日",-1),z=(0,n._)("label",{for:"discount",class:"block text-primary w-full mb-1"},"折扣百分比",-1),B={class:"flex justify-end items-center"},U=(0,n._)("label",{for:"is_enabled",class:"text-primary"},"是否啟用",-1),Z={class:"text-right border-primary border-t-2 p-5"};function q(e,t,o,a,s,l){return(0,n.wg)(),(0,n.iD)("div",{class:(0,r.C_)(["duration-300 fixed overflow-y-auto z-[1000] inset-0",{"opacity-0 invisible":!s.isOpen,"opacity-100 visible":s.isOpen}])},[(0,n._)("div",{class:"fixed top-0 left-0 w-full h-full bg-primary bg-opacity-50",onClick:t[0]||(t[0]=(...e)=>l.closeModal&&l.closeModal(...e))}),(0,n._)("div",k,[(0,n._)("div",M,["add"===o.status?((0,n.wg)(),(0,n.iD)("h2",D," 新增優惠卷 ")):((0,n.wg)(),(0,n.iD)("h2",O," 編輯優惠卷 ")),(0,n._)("div",P,[(0,n._)("div",$,[(0,n._)("div",null,[I,(0,n.wy)((0,n._)("input",{type:"text",id:"title",placeholder:"請輸入標題",class:"text-primary bg-secondary border-primary border-2 w-full h-[60px] px-5","onUpdate:modelValue":t[1]||(t[1]=e=>s.tempCoupon.title=e)},null,512),[[i.nr,s.tempCoupon.title]])]),(0,n._)("div",null,[j,(0,n.wy)((0,n._)("input",{type:"text",id:"couponCode",placeholder:"請輸入優惠碼",class:"text-primary bg-secondary border-primary border-2 w-full h-[60px] px-5","onUpdate:modelValue":t[2]||(t[2]=e=>s.tempCoupon.code=e)},null,512),[[i.nr,s.tempCoupon.code]])]),(0,n._)("div",null,[S,(0,n.wy)((0,n._)("input",{type:"date",id:"dueDate",placeholder:"請輸入到期日",class:"text-primary bg-secondary border-primary border-2 w-full h-[60px] px-5","onUpdate:modelValue":t[3]||(t[3]=e=>s.dueDate=e)},null,512),[[i.nr,s.dueDate]])]),(0,n._)("div",null,[z,(0,n.wy)((0,n._)("input",{type:"text",id:"discount",min:"0",placeholder:"請輸入折扣百分比",class:"text-primary bg-secondary border-primary border-2 w-full h-[60px] px-5","onUpdate:modelValue":t[4]||(t[4]=e=>s.tempCoupon.percent=e)},null,512),[[i.nr,s.tempCoupon.percent,void 0,{number:!0}]])]),(0,n._)("div",B,[(0,n.wy)((0,n._)("input",{type:"checkbox",id:"is_enabled",class:"btn-check mr-2","true-value":1,"false-value":0,"onUpdate:modelValue":t[5]||(t[5]=e=>s.tempCoupon.is_enabled=e)},null,512),[[i.e8,s.tempCoupon.is_enabled]]),U])]),(0,n._)("div",Z,[(0,n._)("button",{type:"button",class:"duration-300 text-warning border-warning border-2 px-12 py-2.5 hover:text-white hover:bg-warning",onClick:t[6]||(t[6]=(...e)=>l.closeModal&&l.closeModal(...e))}," 取消 "),(0,n._)("button",{type:"button",class:"duration-300 text-primary border-primary border-2 px-12 py-2.5 ml-2.5 hover:text-white hover:bg-primary",onClick:t[7]||(t[7]=e=>l.updateCoupon(s.tempCoupon.id))},(0,r.zw)("add"===o.status?"新增":"修改"),1)])])])])],2)}var N={props:{coupon:{type:Object,default(){return{}}},status:{type:String,default:""},currentPage:{type:Number,default:1}},watch:{coupon(){this.tempCoupon=JSON.parse(JSON.stringify(this.coupon));const e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");[this.dueDate]=e},dueDate(){this.tempCoupon.due_date=Math.floor(new Date(this.dueDate)/1e3)},status(){this.tempStatus=this.status}},data(){return{isOpen:!1,tempCoupon:{},dueDate:"",tempStatus:""}},methods:{updateCoupon(e){let t="https://vue3-course-api.hexschool.io/v2/api/rousong/admin/coupon",o="post",n="新增優惠券成功";"add"!==this.tempStatus&&(t=`https://vue3-course-api.hexschool.io/v2/api/rousong/admin/coupon/${e}`,o="put",n="更新優惠券成功"),this.$http[o](t,{data:this.tempCoupon}).then((()=>{w().fire({position:"top-end",icon:"success",title:n,showConfirmButton:!1,timer:1500}),this.$emit("update-coupon",this.currentPage),this.$emit("cancel-id"),this.closeModal()})).catch((e=>{w().fire({position:"top-end",icon:"error",title:e.response.data.message,showConfirmButton:!1,timer:1500})}))},openModal(){this.isOpen=!0},closeModal(){this.isOpen=!1}},mounted(){C.Z.on("update-coupon",(e=>{this.tempStatus="edit",this.tempCoupon=e,this.updateCoupon(e.id)}))}},V=o(3744);const A=(0,V.Z)(N,[["render",q]]);var J=A,H=o(1664),Y={components:{Pagination:_.Z,CouponModal:J,DeleteModal:H.Z},data(){return{coupons:{},tempCoupon:{title:"",is_enabled:0,percent:100,code:""},status:"",pagination:{},navItem:"coupon",tempId:""}},methods:{getCoupons(e=1){const t=`https://vue3-course-api.hexschool.io/v2/api/rousong/admin/coupons?page=${e}`;this.$http.get(t).then((e=>{this.coupons=e.data.coupons,this.pagination=e.data.pagination})).catch((e=>{w().fire({position:"top-end",icon:"error",title:e.response.data.message,showConfirmButton:!1,timer:1500})}))},updateCoupon(e){this.tempId=e.id,C.Z.emit("update-coupon",e)},cancelId(){this.tempId=""},openModal(e,t){this.status=e,"add"===e?(this.tempCoupon={due_date:(new Date).getTime()/1e3},this.$refs.couponModal.openModal()):"edit"===e?(this.tempCoupon=JSON.parse(JSON.stringify(t)),this.$refs.couponModal.openModal()):"delete"===e&&(this.tempCoupon=JSON.parse(JSON.stringify(t)),this.$refs.delCouponModal.openModal())}},mounted(){this.getCoupons()}};const K=(0,V.Z)(Y,[["render",x]]);var T=K},5604:function(e,t,o){e.exports=o.p+"img/icon-arrow-left.6f0ad973.svg"},6058:function(e,t,o){e.exports=o.p+"img/icon-arrow-right.624a1ec8.svg"}}]);
//# sourceMappingURL=815.dd6313d0.js.map