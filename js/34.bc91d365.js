"use strict";(self["webpackChunkdoublebrunch"]=self["webpackChunkdoublebrunch"]||[]).push([[34],{5679:function(t,e,r){function o(t){return{all:t=t||new Map,on:function(e,r){var o=t.get(e);o?o.push(r):t.set(e,[r])},off:function(e,r){var o=t.get(e);o&&(r?o.splice(o.indexOf(r)>>>0,1):t.set(e,[]))},emit:function(e,r){var o=t.get(e);o&&o.slice().map((function(t){t(r)})),(o=t.get("*"))&&o.slice().map((function(t){t(e,r)}))}}}r.d(e,{Z:function(){return i}});const a=o();var i=a},6294:function(t,e,r){var o=r(8262);e["Z"]=(0,o.Q_)("statusStore",{state:()=>({isLoading:!1}),actions:{changeLoading(){this.isLoading=!this.isLoading}}})},8729:function(t,e,r){r.d(e,{Z:function(){return g}});var o=r(6252),a=r(3577);const i=(0,o._)("div",{class:"loading__main"},[(0,o._)("div",{class:"loading__square absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[60px] h-[60px] bg-primary rounded -mt-2"}),(0,o._)("span",{class:"relative block text-24px text-secondary w-full h-full pt-2"},"午")],-1),s=[i];function n(t,e,r,i,n,l){return(0,o.wg)(),(0,o.iD)("div",{class:(0,a.C_)(["loading",{"is-active":r.isLoading}])},s,2)}var l={props:{isLoading:{type:Boolean,default:!1}}},c=r(3744);const p=(0,c.Z)(l,[["render",n]]);var g=p},8268:function(t,e,r){r.d(e,{Z:function(){return w}});var o=r(6252),a=r(3577),i=r(5604),s=r(6058);const n={class:"flex justify-center h-[60px] border-primary border-t-2"},l=["disabled"],c=(0,o._)("img",{src:i,alt:"icon-arrow-left",class:"duration-300 group-hover:scale-110"},null,-1),p=[c],g=["onClick"],u=["disabled"],d=(0,o._)("img",{src:s,alt:"icon-arrow-right",class:"duration-300 group-hover:scale-110"},null,-1),h=[d];function f(t,e,r,i,s,c){return(0,o.wg)(),(0,o.iD)("ul",n,[(0,o._)("li",null,[(0,o._)("button",{type:"button",class:(0,a.C_)(["flex justify-center items-center opacity-50 h-full cursor-not-allowed px-[25px] group",{"opacity-100 cursor-pointer":r.pages.has_pre}]),disabled:1===r.pages.current_page,onClick:e[0]||(e[0]=t=>c.changePages(r.pages.current_page-1))},p,10,l)]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.pages.total_pages,((t,e)=>((0,o.wg)(),(0,o.iD)("li",{key:e},[(0,o._)("button",{type:"button",class:(0,a.C_)(["duration-300 flex justify-center items-center text-primary opacity-50 h-full px-[15px] hover:text-primary hover:opacity-100",{"opacity-100":t===r.pages.current_page}]),onClick:e=>c.changePages(t)},(0,a.zw)(t),11,g)])))),128)),(0,o._)("li",null,[(0,o._)("button",{type:"button",class:(0,a.C_)(["flex justify-center items-center opacity-50 h-full cursor-not-allowed px-[25px] group",{"opacity-100 cursor-pointer":r.pages.has_next}]),disabled:r.pages.current_page===r.pages.total_pages,onClick:e[1]||(e[1]=t=>c.changePages(r.pages.current_page+1))},h,10,u)])])}var y={props:{pages:{type:Object,default(){return{}}}},methods:{changePages(t){this.$emit("change-pages",t)}}},m=r(3744);const v=(0,m.Z)(y,[["render",f]]);var w=v},1034:function(t,e,r){r.r(e),r.d(e,{default:function(){return et}});var o=r(6252),a=r(3577),i=r(9963),s=r(4220),n=r(9653);const l={class:"border-primary border-b-2 p-5 md:hidden"},c={class:"relative"},p=(0,o._)("option",{value:"all"},"全部餐點",-1),g=["value"],u=(0,o._)("svg",{class:"absolute top-1/2 right-4 -translate-y-1/2",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"20",height:"20",viewBox:"0 0 20 20"},[(0,o._)("defs",null,[(0,o._)("clipPath",{id:"clip-path"},[(0,o._)("rect",{id:"Rectangle_210","data-name":"Rectangle 210",width:"20",height:"20"})])]),(0,o._)("g",{id:"icon-arrow-left",transform:"translate(0 20) rotate(-90)","clip-path":"url(#clip-path)"},[(0,o._)("path",{id:"Path_14","data-name":"Path 14",d:"M1078.15,822.453l-8,8,8,8",transform:"translate(-1064.147 -820.453)",fill:"none",stroke:"#8CA06E","stroke-width":"2"})])],-1),d={class:"category hidden flex-wrap justify-center border-primary border-b-2 py-5 md:flex"},h={class:"md:px-[15px] md:py-2 lg:p-[15px]"},f=["onClick"],y={class:"p-5"},m={class:"grid grid-cols-1 gap-5 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5"},v={class:"relative border-primary border-2"},w={class:"absolute top-0 left-5 z-20"},x=(0,o._)("img",{src:s,alt:"標籤"},null,-1),_={class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-white"},b={class:"relative pt-[100%] overflow-hidden"},C=["src","alt"],k={class:"flex justify-between border-primary border-t-2 p-5"},$={class:"text-20px text-primary"},L={class:"text-20px text-primary"},P={class:"flex border-primary border-x-2 border-b-2"},D=["onClick"],Z={key:0,src:n,alt:"愛心",class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},j={key:1,class:"duration-300 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 stroke-primary fill-transparent group-hover:fill-primary",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"20",height:"20",viewBox:"0 0 20 20"},q=(0,o._)("defs",null,[(0,o._)("clipPath",{id:"clip-icon-favorite"},[(0,o._)("rect",{width:"20",height:"20"})])],-1),B=(0,o._)("g",{id:"icon-favorite","clip-path":"url(#clip-icon-favorite)"},[(0,o._)("path",{id:"heart-solid",d:"M14.435,32.924a4.273,4.273,0,0,0-5.831.425l-.616.634-.616-.634a4.273,4.273,0,0,0-5.831-.425,4.487,4.487,0,0,0-.309,6.5l6.047,6.244a.98.98,0,0,0,1.416,0l6.047-6.244a4.484,4.484,0,0,0-.306-6.5Z",transform:"translate(2.012 -28.967)","stroke-width":"2"})],-1),z=[q,B],I={class:"relative flex-1"},M={key:0,type:"button",class:"flex justify-center items-center text-primary border-primary border-l-2 w-full h-full pointer-events-none"},S=["onClick"],H=(0,o._)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",class:"duration-[400ms] stroke-primary group-hover:stroke-white"},[(0,o._)("rect",{width:"16",height:"12",rx:"3",transform:"translate(2 6)",fill:"none","stroke-width":"2"}),(0,o._)("path",{d:"M13,9V5A4,4,0,0,0,5,5V9",transform:"translate(1 1)",fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})],-1),F=(0,o._)("span",{class:"ml-3"},"加入購物車",-1),N=[H,F],O={class:"absolute inset-0 flex justify-center items-center bg-primary"},Y=(0,o.uE)('<div class="flex items-center"><svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><span class="text-white">加入中...</span></div>',1),K=[Y];function V(t,e,r,s,n,q){const B=(0,o.up)("LoadingComponent"),H=(0,o.up)("router-link"),F=(0,o.up)("Pagination");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(B,{isLoading:t.isLoading},null,8,["isLoading"]),(0,o._)("section",null,[(0,o._)("div",l,[(0,o._)("div",c,[(0,o.wy)((0,o._)("select",{class:"text-primary bg-secondary border-primary border-2 w-full px-4 py-2","onUpdate:modelValue":e[0]||(e[0]=t=>n.category=t),onChange:e[1]||(e[1]=t=>q.changeCategory(n.category))},[p,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.categories,(t=>((0,o.wg)(),(0,o.iD)("option",{value:t,key:t},(0,a.zw)(t)+"系列 ",9,g)))),128))],544),[[i.bM,n.category]]),u])]),(0,o._)("ul",d,[(0,o._)("li",h,[(0,o._)("button",{type:"button",class:(0,a.C_)(["text-14px text-primary opacity-50",{"opacity-100":"all"===n.category}]),onClick:e[2]||(e[2]=t=>q.changeCategory("all"))}," 全部餐點 ",2)]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.categories,(t=>((0,o.wg)(),(0,o.iD)("li",{class:"md:px-[15px] md:py-2 lg:p-[15px]",key:t},[(0,o._)("button",{type:"button",class:(0,a.C_)(["text-14px text-primary opacity-50",{"opacity-100":n.category===t}]),onClick:e=>q.changeCategory(t)},(0,a.zw)(t)+"系列 ",11,f)])))),128))]),(0,o._)("div",y,[(0,o._)("ul",m,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.products,(e=>((0,o.wg)(),(0,o.iD)("li",{key:e.id},[(0,o._)("div",v,[(0,o._)("div",w,[x,(0,o._)("span",_,(0,a.zw)(e.category),1)]),(0,o.Wm)(H,{to:`/product/${e.id}`,class:"group block"},{default:(0,o.w5)((()=>[(0,o._)("div",b,[(0,o._)("img",{src:e.imageUrl,alt:e.title,class:"duration-300 absolute top-0 left-0 w-full h-full object-cover group-hover:scale-110"},null,8,C)])])),_:2},1032,["to"]),(0,o._)("div",k,[(0,o._)("h4",$,(0,a.zw)(e.title),1),(0,o._)("span",L,"$"+(0,a.zw)(t.$filters.currency(e.price)),1)])]),(0,o._)("div",P,[(0,o._)("button",{type:"button",class:"relative w-[60px] h-[60px] group",onClick:t=>q.toggleFavorite(e)},[q.isFavorite(e)?((0,o.wg)(),(0,o.iD)("img",Z)):((0,o.wg)(),(0,o.iD)("svg",j,z))],8,D),(0,o._)("div",I,[q.isMaxNum(e)?((0,o.wg)(),(0,o.iD)("button",M," 商品已達購買上限 ")):((0,o.wg)(),(0,o.iD)("button",{key:1,type:"button",class:"btn duration-[400ms] flex justify-center items-center border-primary border-l-2 w-full h-full group",onClick:t=>q.addToCart(e.id)},N,8,S)),(0,o.wy)((0,o._)("div",O,K,512),[[i.F8,n.isLoadingItem===e.id]])])])])))),128))])]),n.pagination.total_pages>1?((0,o.wg)(),(0,o.j4)(F,{key:0,pages:n.pagination,onChangePages:q.getProducts},null,8,["pages","onChangePages"])):(0,o.kq)("",!0)])],64)}var A=r(6455),E=r.n(A),J=r(5679),R=r(8262),T=r(6294),U=r(8729),W=r(8268);const Q=(0,T.Z)();var G={components:{LoadingComponent:U.Z,Pagination:W.Z},watch:{$route:{handler(){this.$route.query.category&&this.$route.query.page&&(this.category=this.$route.query.category,this.page=this.$route.query.page,this.getProducts(this.page))}},favorite:{handler(){localStorage.setItem("favorite",JSON.stringify(this.favorite)),J.Z.emit("get-favorite")},deep:!0}},data(){return{products:[],pagination:{},cart:{carts:[]},page:1,category:"all",categories:[],favorite:JSON.parse(localStorage.getItem("favorite"))||[],isLoadingItem:""}},computed:{...(0,R.rn)(T.Z,["isLoading"])},methods:{changeCategory(t){this.category=t,this.getProducts()},getCategories(){const t="https://vue3-course-api.hexschool.io/v2/api/rousong/products/all";this.$http.get(t).then((t=>{const{products:e}=t.data,r=new Set;e.forEach((t=>{r.add(t.category)})),this.categories=[...r].reverse()})).catch((t=>{E().fire({position:"top-end",icon:"error",title:t.response.data.message,showConfirmButton:!1,timer:1500})}))},getProducts(t=1){Q.isLoading=!0;let e=`https://vue3-course-api.hexschool.io/v2/api/rousong/products?page=${t}`;"all"!==this.category?(e=`https://vue3-course-api.hexschool.io/v2/api/rousong/products?category=${this.category}&page=${t}`,this.$router.push(`/products?category=${this.category}&page=${t}`)):this.$router.push(`/products?category=all&page=${t}`),this.$http.get(e).then((t=>{this.products=t.data.products,this.pagination=t.data.pagination,Q.isLoading=!1})).catch((t=>{E().fire({position:"top-end",icon:"error",title:t.response.data.message,showConfirmButton:!1,timer:1500})}))},getCart(){const t="https://vue3-course-api.hexschool.io/v2/api/rousong/cart";this.$http.get(t).then((t=>{this.cart=t.data.data})).catch((t=>{E().fire({position:"top-end",icon:"error",title:t.response.data.message,showConfirmButton:!1,timer:1500})}))},addToCart(t,e=1){this.isLoadingItem=t;const r={product_id:t,qty:e},o="https://vue3-course-api.hexschool.io/v2/api/rousong/cart",a="已加入購物車";this.$http.post(o,{data:r}).then((()=>{E().fire({position:"top-end",icon:"success",title:a,showConfirmButton:!1,timer:1500}),J.Z.emit("get-cart"),this.getCart(),this.isLoadingItem=""})).catch((t=>{E().fire({position:"top-end",icon:"error",title:t.response.data.message,showConfirmButton:!1,timer:1500})}))},toggleFavorite(t){const e=this.favorite.findIndex((e=>e.id===t.id));-1===e?(this.favorite.push(t),E().fire({position:"top-end",icon:"success",title:"已加入我的最愛",showConfirmButton:!1,timer:1500})):(this.favorite.splice(e,1),E().fire({position:"top-end",icon:"success",title:"已移除我的最愛",showConfirmButton:!1,timer:1500}))},isFavorite(t){return this.favorite.some((e=>e.id===t.id))},isMaxNum(t){const e=this.cart.carts.filter((e=>e.product_id===t.id))[0];return e&&30===e.qty}},mounted(){this.$route.query.category&&this.$route.query.page&&(this.category=this.$route.query.category,this.page=this.$route.query.page,this.getProducts(this.page)),this.getCategories(),this.getCart(),J.Z.on("update-favorite",(()=>{this.favorite=JSON.parse(localStorage.getItem("favorite"))||[]}))}},X=r(3744);const tt=(0,X.Z)(G,[["render",V]]);var et=tt},5604:function(t,e,r){t.exports=r.p+"img/icon-arrow-left.6f0ad973.svg"},6058:function(t,e,r){t.exports=r.p+"img/icon-arrow-right.624a1ec8.svg"},9653:function(t,e,r){t.exports=r.p+"img/icon-heart-fill.67c81960.svg"},4220:function(t,e,r){t.exports=r.p+"img/icon-tag.319e6611.svg"}}]);
//# sourceMappingURL=34.bc91d365.js.map